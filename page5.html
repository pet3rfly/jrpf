<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆè‚¥å¸‚ä¸åŠ¨äº§ç™»è®°ä¿¡æ¯æŸ¥è¯¢ç»“æœ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --font-song: "SimSun", "Songti SC", serif;
            --font-hei: "SimHei", "Heiti SC", sans-serif;
            --border-color: #000;
        }

        @page { size: A4; margin: 0; }

        body {
            background-color: #e0e0e0;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: var(--font-song);
            color: #000;
        }

        .a4-page {
            background: white;
            width: 210mm;
            height: 297mm;
            padding: 25mm 5mm 5mm 5mm;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            position: relative;
            box-sizing: border-box;
            overflow: hidden;
        }

        @media print {
            body { background: none; padding: 0; }
            .a4-page {
                box-shadow: none;
                width: 210mm; height: 297mm;
                padding: 25mm 5mm 5mm 5mm;
                margin: 0;
                page-break-after: always;
            }
            .control-panel, .btn-group { display: none !important; }
            -webkit-print-color-adjust: exact;
        }

        #bg-watermark {
            position: absolute; top: 40px; left: 0px; width: 100%; height: 100%;
            z-index: 0; object-fit: cover; pointer-events: none; opacity: 0.8;
        }
        #stamp-layer {
            position: absolute; z-index: 5;
            width: 160px; top: 350px; left: 400px;
            pointer-events: none; mix-blend-mode: multiply; transform: rotate(-15deg);
        }
        .content-layer {
            position: relative; z-index: 10; background: transparent; 
        }

        .header {
            display: flex; justify-content: space-between; align-items: flex-start;
            margin-bottom: 20px;
        }
        .header-title { text-align: center; width: 100%; padding-left: 120px; }
        .header-title h1 {
            font-size: 22px; font-weight: bold; font-family: var(--font-hei);
            margin: 0 0 15px 0; letter-spacing: 1px;
        }
        .header-info { font-size: 16px; text-align: left; margin: 0; }
        .qr-code { width: 120px; height: 120px; object-fit: contain; }

        .section-title {
            font-size: 16px; 
            font-weight: normal; 
            margin: 10px 0 2px 0;
            font-family: var(--font-song);
        }

        table {
            width: 100%; border-collapse: collapse; margin-bottom: 2px;
            table-layout: fixed; 
            font-size: 16px; 
            background: transparent;
        }
        
        th, td {
            border: 1px solid #000;
            padding: 2px 1px;
            text-align: center; 
            vertical-align: middle;
            line-height: 1.1; word-break: break-all;
            font-weight: normal;
        }
        
        td[contenteditable="true"] { outline: none; }
        [contenteditable="true"]:hover { background-color: rgba(255, 255, 0, 0.1); cursor: text; }
        [contenteditable="true"]:focus { background-color: rgba(255, 255, 255, 0.8); }

        .footer-date {
            text-align: right; font-size: 16px;
            margin-top: 8px; margin-bottom: 5px;
            margin-right: 4em;
        }
        .footer-notes { font-size: 16px; line-height: 1.4; color: #333; margin-top: 5px; }

        .btn-group {
            position: fixed; top: 20px; right: 20px; z-index: 10001;
            display: flex; gap: 10px;
        }
        .float-btn {
            padding: 8px 15px; background: #2258da; color: #fff;
            border: none; border-radius: 4px; cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3); font-size: 14px;
            font-family: "Microsoft YaHei";
        }
        .float-btn.green { background: #28a745; }
        .float-btn:hover { opacity: 0.9; }

        .control-panel {
            position: fixed; bottom: 20px; right: 20px; background: #fff;
            border: 1px solid #ccc; padding: 15px; z-index: 10000;
            width: 280px; box-shadow: 0 0 15px rgba(0,0,0,0.2);
            border-radius: 8px; font-size: 12px; font-family: "Microsoft YaHei";
            transition: all 0.3s ease;
        }
        .control-panel.collapsed {
            width: 40px; height: 40px; padding: 0; border-radius: 50%;
            background: #2258da; cursor: pointer; display: flex; align-items: center; justify-content: center;
        }
        .control-panel.collapsed .panel-content { display: none; }
        .toggle-icon { display: none; color: white; font-size: 20px; }
        .control-panel.collapsed .toggle-icon { display: block; }
        
        .panel-header {
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid #eee; margin-bottom: 10px; padding-bottom: 5px;
        }
        .minimize-btn { 
            cursor: pointer; font-size: 16px; width: 16px; height: 16px; 
            display: flex; align-items: center; justify-content: center; 
            font-weight: bold; color: #666;
        }
        .control-row { margin-bottom: 10px; }
        .control-row label { display: block; margin-bottom: 3px; font-weight: bold; color: #555; }
        .control-row input { width: 95%; padding: 5px; border: 1px solid #ddd; }
        .slider-container { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
        .slider-container input { flex: 1; }

    </style>
</head>
<body>

    <div class="btn-group">
        <button class="float-btn green" onclick="saveAsImage()">ğŸ–¼ï¸ å­˜ä¸ºå›¾ç‰‡</button>
        <button class="float-btn" onclick="window.print()">ğŸ–¨ï¸ æ‰“å° / PDF</button>
    </div>

    <div class="a4-page" id="capture-area">
        <img src="bdcæ°´å°.jpg" id="bg-watermark" alt="æ°´å°" style="top: 40px; left: 0px;">
        <img src="hfbdc.png" id="stamp-layer" alt="å°ç« " style="top: 375px; left: 460px; width: 160px;">

        <div class="content-layer">
            
            <div class="header">
                <div class="header-title">
                    <h1>åˆè‚¥å¸‚ä¸åŠ¨äº§ç™»è®°ä¿¡æ¯æŸ¥è¯¢ç»“æœ</h1>
                    <div class="header-info" contenteditable="true">ä¾ç”³è¯·ï¼Œç»è¿‡æŸ¥è¯¢ åˆè‚¥å¸‚ä¸åŠ¨äº§ç»Ÿä¸€ç™»è®°ä¿¡æ¯ç®¡ç†ç³»ç»Ÿï¼Œç»“æœå¦‚ä¸‹ï¼š</div>
                </div>
                <img src="hfqr-100.jpg" id="qr-img" class="qr-code" alt="QR">
            </div>

            <div class="section-title">äº§æƒä¿¡æ¯</div>
            <table>
                <colgroup>
                    <col style="width: 28%">
                    <col style="width: 12%">
                    <col style="width: 25%">
                    <col style="width: 12%">
                    <col style="width: 11%">
                    <col style="width: 12%">
                </colgroup>
                <tr>
                    <th>ä¸åŠ¨äº§æƒè¯å·</th>
                    <th>æƒåˆ©äºº</th>
                    <th>è¯ä»¶å·</th>
                    <th>ç™»è®°ç±»å‹</th>
                    <th>ç™»è®°åŸå› </th>
                    <th>ç™»è®°æ—¶é—´</th>
                </tr>
                <tr>
                    <td contenteditable="true">çš–(2021)åˆè‚¥å¸‚ä¸åŠ¨äº§æƒ<br>ç¬¬4145544å·</td>
                    <td contenteditable="true">é¡¾éœ²äº‘</td>
                    <td contenteditable="true">342622199106302421</td>
                    <td contenteditable="true">è½¬ç§»ç™»è®°</td>
                    <td contenteditable="true">å­˜é‡æˆ¿ä¹°å–</td>
                    <td contenteditable="true">2021-10-22</td>
                </tr>
            </table>

            <div class="section-title">ä¸åŠ¨äº§è¯¦æƒ…ï¼ˆé¢ç§¯å•ä½ï¼šå¹³æ–¹ç±³ï¼‰</div>
            <table>
                <colgroup>
                    <col style="width: 8%">
                    <col style="width: 8%">
                    <col style="width: 8%">
                    <col style="width: 10%">
                    <col style="width: 14%">
                    <col style="width: 12%">
                    <col style="width: 12%">
                    <col style="width: 12%">
                    <col style="width: 16%">
                </colgroup>
                <tr>
                    <td colspan="2">å…±æœ‰æƒ…å†µ</td>
                    <td colspan="2" contenteditable="true">å•ç‹¬æ‰€æœ‰</td>
                    <td colspan="2">ä¸åŠ¨äº§å•å…ƒå·</td>
                    <td colspan="3" contenteditable="true">340104401007GB00071F00020062</td>
                </tr>
                <tr>
                    <td colspan="2">åè½</td>
                    <td colspan="7" contenteditable="true">èœ€å±±åŒºåé‡Œåº—è·¯719å·æ¸…æºªå®¶å›­5å¹¢1602</td>
                </tr>
                <tr>
                    <td>æ€»å±‚æ•°</td>
                    <td>æ‰€åœ¨å±‚</td>
                    <td>å®¤å·</td>
                    <td>è§„åˆ’ç”¨é€”</td>
                    <td>æˆ¿å±‹æ€§è´¨</td>
                    <td>å»ºç­‘é¢ç§¯</td>
                    <td>ä¸“æœ‰é¢ç§¯</td>
                    <td>åˆ†æ‘Šé¢ç§¯</td>
                    <td>ç«£å·¥æ—¶é—´</td>
                </tr>
                <tr>
                    <td contenteditable="true">18</td>
                    <td contenteditable="true">16</td>
                    <td contenteditable="true">1602</td>
                    <td contenteditable="true">ä½å®…</td>
                    <td contenteditable="true">å¸‚åœºåŒ–å•†å“æˆ¿</td>
                    <td contenteditable="true">97.02</td>
                    <td contenteditable="true">81.36</td>
                    <td contenteditable="true">15.66</td>
                    <td contenteditable="true">2017-06-30</td>
                </tr>
                <tr>                    
                    <td colspan="2">åœŸåœ°ä½¿ç”¨é¢ç§¯</td>
                    <td colspan="2" contenteditable="true">50188.64</td>
                    <td colspan="2">åœŸåœ°ä½¿ç”¨æœŸé™</td>
                    <td colspan="3" contenteditable="true">è‡³2090-06-27</td>
                </tr>
                <tr>
                    <td colspan="2">å®—åœ°é¢ç§¯</td>
                    <td colspan="3" contenteditable="true">50188.64</td>
                    <td colspan="2">å®—åœ°æ€§è´¨</td>
                    <td colspan="2" contenteditable="true">å‡ºè®©</td>
                </tr>
                <tr>
                    <td colspan="2">å®—åœ°æƒåˆ©ç±»å‹</td>
                    <td colspan="3" contenteditable="true">å›½æœ‰å»ºè®¾ç”¨åœ°ä½¿ç”¨æƒ</td>
                    <td colspan="2">å®—åœ°ç”¨é€”</td>
                    <td colspan="2" contenteditable="true">åŸé•‡ä½å®…ç”¨åœ°</td>
                </tr>
                <tr>
                    <td colspan="2">å®—åœ°ç”¨é€” 2</td>
                    <td colspan="3" contenteditable="true"></td>
                    <td colspan="2">å®—åœ°ç”¨é€” 3</td>
                    <td colspan="2" contenteditable="true"></td>
                </tr>
                <tr>
                    <td colspan="2">é™„è®°</td>
                    <td colspan="7" contenteditable="true"></td>
                </tr>
            </table>

            <div class="section-title">æŠµæŠ¼ä¿¡æ¯ï¼ˆé‡‘é¢å•ä½ï¼šä¸‡å…ƒï¼‰</div>
            <table>
                <colgroup>
                    <col style="width: 22%"> <col style="width: 15%"> <col style="width: 10%"> <col style="width: 10%"> <col style="width: 15%"> <col style="width: 12%"> <col style="width: 10%"> <col style="width: 6%">  </colgroup>
                <tr>
                    <th>ä¸åŠ¨äº§è¯æ˜å·</th>
                    <th>æŠµæŠ¼æƒäºº</th>
                    <th>æŠµæŠ¼æ–¹å¼</th>
                    <th>æŠµæŠ¼é‡‘é¢</th>
                    <th>å€ºåŠ¡å±¥è¡ŒæœŸé™</th>
                    <th>ç™»è®°æ—¶é—´</th>
                    <th>ç¦æ­¢è½¬è®©</th>
                    <th>é™„è®°</th>
                </tr>
                <tr>
                    <td contenteditable="true">çš–(2025)åˆè‚¥å¸‚ä¸åŠ¨<br>äº§è¯æ˜ç¬¬4009908å·</td>
                    <td contenteditable="true">å®‰å¾½ä¹é¼å…¸å½“<br>æœ‰é™å…¬å¸</td>
                    <td contenteditable="true">ä¸€èˆ¬æŠµæŠ¼</td>
                    <td contenteditable="true">64</td>
                    <td contenteditable="true">2025-11-27 è‡³<br>2025-12-26</td>
                    <td contenteditable="true">2025-12-01</td>
                    <td contenteditable="true">æ˜¯</td>
                    <td contenteditable="true"></td>
                </tr>
            </table>

            <div class="section-title">æŸ¥å°ä¿¡æ¯ï¼ˆæ³¨ï¼šè½®å€™æŸ¥å°çš„å®é™…èµ·æ­¢æ—¥æœŸä¸ºå¾…å®šï¼‰</div>
            <table>
                <colgroup>
                    <col style="width: 15%">
                    <col style="width: 10%">
                    <col style="width: 20%">
                    <col style="width: 15%">
                    <col style="width: 15%">
                    <col style="width: 10%">
                    <col style="width: 15%">
                </colgroup>
                <tr>
                    <th>æŸ¥å°æœºæ„</th>
                    <th>æŸ¥å°ç±»å‹</th>
                    <th>æŸ¥å°æ–‡å·</th>
                    <th>æŸ¥å°å¼€å§‹æ—¶é—´</th>
                    <th>æŸ¥å°ç»“æŸæ—¶é—´</th>
                    <th>æ˜¯å¦è§£å°</th>
                    <th>é™„è®°</th>
                </tr>
                <tr>
                    <td contenteditable="true" style="height: 18px;"></td>
                    <td contenteditable="true"></td>
                    <td contenteditable="true"></td>
                    <td contenteditable="true"></td>
                    <td contenteditable="true"></td>
                    <td contenteditable="true"></td>
                    <td contenteditable="true"></td>
                </tr>
            </table>

            <div class="section-title">å¼‚è®®ä¿¡æ¯</div>
            <table>
                <tr>
                    <th style="width: 50%">å¼‚è®®äº‹é¡¹</th>
                    <th style="width: 50%">é™„è®°</th>
                </tr>
                <tr>
                    <td contenteditable="true" style="height: 18px;"></td>
                    <td contenteditable="true"></td>
                </tr>
            </table>

            <div class="section-title">å±…ä½æƒä¿¡æ¯</div>
            <table>
                <colgroup>
                    <col style="width: 25%">
                    <col style="width: 20%">
                    <col style="width: 20%">
                    <col style="width: 15%">
                    <col style="width: 20%">
                </colgroup>
                <tr>
                    <th>ä¸åŠ¨äº§è¯æ˜å·</th>
                    <th>å±…ä½æƒäºº</th>
                    <th>å±…ä½æƒæœŸé™</th>
                    <th>ç™»è®°æ—¶é—´</th>
                    <th>é™„è®°</th>
                </tr>
                <tr>
                    <td contenteditable="true" style="height: 18px;"></td>
                    <td contenteditable="true"></td>
                    <td contenteditable="true"></td>
                    <td contenteditable="true"></td>
                    <td contenteditable="true"></td>
                </tr>
            </table>

            <div class="footer-date" id="footerDateDisplay" contenteditable="true">
                2025 å¹´ 12 æœˆ 22 æ—¥ 14 æ—¶ 52 åˆ†
            </div>

            <div class="footer-notes">
                è¯´æ˜ï¼š<br>
                1ã€æœ¬æ¬¡æŸ¥è¯¢ç»“æœä¾æ®ä¸åŠ¨äº§ï¼ˆå«æˆ¿å±‹ï¼‰ç™»è®°ç°¿å‡ºå…·ï¼Œåæ˜ æŸ¥è¯¢äººç›®å‰å®é™…æ‹¥æœ‰çš„ä¸åŠ¨äº§æƒåˆ©ç™»è®°ä¿¡æ¯ã€‚<br>
                2ã€å¯èƒ½å› è¢«æŸ¥è¯¢äººèº«ä»½ä¿¡æ¯ä¸ç™»è®°ç°¿ä¸ä¸€è‡´å¯¼è‡´é”™è¯¯ç»“æœï¼ŒæŸ¥è¯¢äººè¯·å½“åœºæ ¸å®ä»¥ä¸Šèº«ä»½ä¿¡æ¯å’Œç»“æœä¿¡æ¯ï¼Œ<br>
                å¦‚ä¿¡æ¯æœ‰è¯¯æˆ–å¼‚è®®ï¼Œè¯·å‘ŠçŸ¥æ¡£æ¡ˆæŸ¥è¯¢å·¥ä½œäººå‘˜äºˆä»¥æ ¸å®ï¼Œå¦‚æœ‰éšç’æˆ–æä¾›è™šå‡ä¿¡æ¯è‡ªè¡Œæ‰¿æ‹…æ³•å¾‹è´£ä»»ã€‚<br>
                3ã€æŸ¥è¯¢ç»“æœä¸­ç©ºç™½æ ï¼Œå‡ä¸ºç™»è®°ç°¿ä¸­æ— æ­¤é¡¹ä¿¡æ¯ã€‚<br>
                4ã€æŸ¥è¯¢äººå¯¹ä»¥ä¸ŠæŸ¥è¯¢ä¸­æ¶‰åŠçš„ç›¸å…³ä¿¡æ¯è´Ÿæœ‰ä¿å¯†ä¹‰åŠ¡ã€‚
            </div>

        </div>
    </div>

    <div class="control-panel" id="controlPanel">
        <div class="toggle-icon" onclick="toggleControlPanel()">âš™</div>
        
        <div class="panel-content">
            <div class="panel-header">
                <h4>é¡µé¢å…ƒç´ æ§åˆ¶</h4>
                <span class="minimize-btn" onclick="toggleControlPanel()" title="æ”¶èµ·">_</span>
            </div>

            <div class="control-row">
                <label>æ—¥æœŸæ—¶é—´è®¾ç½®</label>
                <input type="datetime-local" id="datePicker" step="60" onchange="updateDate()">
            </div>

            <div class="control-row">
                <label>æ›¿æ¢äºŒç»´ç  (hfqr-100.jpg)</label>
                <input type="file" accept="image/*" onchange="loadQR(this)">
            </div>

            <div class="control-row" style="margin-top:15px; border-top:1px dashed #ccc; padding-top:10px;">
                <label>å°ç« ä½ç½® (ä¸Šä¸‹)</label>
                <div class="slider-container">
                    <input type="range" id="stampTop" min="0" max="1000" value="350" oninput="updateStamp()">
                </div>
            </div>

            <div class="control-row">
                <label>å°ç« ä½ç½® (å·¦å³)</label>
                <div class="slider-container">
                    <input type="range" id="stampLeft" min="0" max="700" value="400" oninput="updateStamp()">
                </div>
            </div>

            <div class="control-row">
                <label>å°ç« å¤§å°</label>
                <div class="slider-container">
                    <input type="range" id="stampSize" min="50" max="300" value="160" oninput="updateStamp()">
                </div>
            </div>

            <div class="control-row" style="margin-top:15px; border-top:1px dashed #ccc; padding-top:10px;">
                <label>åº•çº¹ä½ç½® (ä¸Šä¸‹)</label>
                <div class="slider-container">
                    <input type="range" id="wmTop" min="-200" max="200" value="40" oninput="updateWatermark()">
                </div>
            </div>

            <div class="control-row">
                <label>åº•çº¹ä½ç½® (å·¦å³)</label>
                <div class="slider-container">
                    <input type="range" id="wmLeft" min="-200" max="200" value="0" oninput="updateWatermark()">
                </div>
            </div>
        </div>
    </div>

    <script>
// åˆå§‹åŒ–æ—¥æœŸ
        window.onload = function() {
            // ä¿®æ”¹ç‚¹1ï¼šå»æ‰æ‹¬å·é‡Œçš„å†…å®¹ï¼Œå³è·å–å½“å‰æ—¶é—´
            const now = new Date(); 
            
            const picker = document.getElementById('datePicker');
            const yyyy = now.getFullYear();
            const MM = String(now.getMonth() + 1).padStart(2, '0');
            const dd = String(now.getDate()).padStart(2, '0');
            const hh = String(now.getHours()).padStart(2, '0');
            const mm = String(now.getMinutes()).padStart(2, '0');
            picker.value = `${yyyy}-${MM}-${dd}T${hh}:${mm}`;

            // ä¿®æ”¹ç‚¹2ï¼šå¢åŠ è¿™ä¸€è¡Œï¼Œé¡µé¢åŠ è½½æ—¶ç«‹å³æ›´æ–°åº•éƒ¨æ–‡å­—
            updateDate(); 
        }

        function toggleControlPanel() {
            document.getElementById('controlPanel').classList.toggle('collapsed');
        }

        function updateDate() {
            const val = document.getElementById('datePicker').value;
            if(val) {
                const d = new Date(val);
                const year = d.getFullYear();
                const month = d.getMonth() + 1;
                const date = d.getDate();
                const hour = d.getHours();
                const minute = String(d.getMinutes()).padStart(2, '0');
                
                const text = `${year} å¹´ ${month} æœˆ ${date} æ—¥ ${hour} æ—¶ ${minute} åˆ†`;
                document.getElementById('footerDateDisplay').innerText = text;
            }
        }

        function saveAsImage() {
            const element = document.getElementById('capture-area');
            html2canvas(element, {
                scale: 2, 
                useCORS: true,
                allowTaint: true, 
                backgroundColor: "#ffffff",
                scrollX: 0,
                scrollY: 0,
                height: element.offsetHeight,
                width: element.offsetWidth
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'ä¸åŠ¨äº§äº§è°ƒç»“æœ.jpg';
                link.href = canvas.toDataURL('image/jpeg', 0.9);
                link.click();
            }).catch(err => {
                console.error("å¯¼å‡ºå›¾ç‰‡å¤±è´¥:", err);
                alert("å¯¼å‡ºå¤±è´¥ã€‚è¯·ç¡®ä¿æ–‡ä»¶å·²éƒ¨ç½²åœ¨æœåŠ¡å™¨(å¦‚GitHub Pages)ä¸Šï¼Œè€Œéç›´æ¥åŒå‡»æ‰“å¼€ã€‚");
            });
        }

        function loadQR(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById('qr-img').src = e.target.result;
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function updateStamp() {
            var top = document.getElementById('stampTop').value;
            var left = document.getElementById('stampLeft').value;
            var size = document.getElementById('stampSize').value;
            var stamp = document.getElementById('stamp-layer');
            stamp.style.top = top + 'px';
            stamp.style.left = left + 'px';
            stamp.style.width = size + 'px';
        }

        function updateWatermark() {
            var top = document.getElementById('wmTop').value;
            var left = document.getElementById('wmLeft').value;
            var wm = document.getElementById('bg-watermark');
            wm.style.top = top + 'px';
            wm.style.left = left + 'px';
        }
    </script>
</body>
</html>