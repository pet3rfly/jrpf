<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­ä¿¡é“¶è¡Œ - ä¸ªäººè´·æ¬¾ç»“æ¸…è¯æ˜</title>
    <style>
        :root {
            --font-fangsong: "FangSong", "STFangsong", "SimSun", serif;
            --margin-x: 100px; 
            --margin-top: 100px;
            --font-size-std: 12pt; /* å°å››å·å­—æ ‡å‡† */
        }

        @page { size: A4; margin: 0; }

        body {
            background-color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            font-family: var(--font-fangsong);
        }

        .a4-page {
            background: white;
            width: 210mm;
            height: 297mm;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            position: relative;
            box-sizing: border-box;
            padding-top: var(--margin-top); 
            padding-left: var(--margin-x);
            padding-right: var(--margin-x);
            overflow: hidden; 
        }

        @media print {
            body { background: none; padding: 0; }
            .a4-page { box-shadow: none; margin: 0; height: auto; min-height: 297mm;}
            .controls { display: none !important; }
        }

        /* === å¤´éƒ¨ === */
        .header { margin-bottom: 40px; }
        .header img {
            width: 120px; 
            display: block;
        }

        /* === æ ‡é¢˜ === */
        .doc-title {
            text-align: center;
            font-size: 30px; 
            font-weight: bold; 
            margin-bottom: 50px;
            letter-spacing: 2px;
            color: #000;
        }

        /* === ç»Ÿä¸€æ­£æ–‡æ ·å¼ (æ­£æ–‡ã€éªŒè¯ç ã€å£°æ˜ã€æ—¥æœŸ) === */
        .std-text {
            font-size: var(--font-size-std); /* å°å››å· */
            line-height: 2.0; /* 2å€è¡Œè· */
            color: #000;
            font-weight: normal;
            text-align: left; /* å–æ¶ˆä¸¤ç«¯å¯¹é½ */
        }

        .doc-body {
            text-indent: 2em; /* é¦–è¡Œç¼©è¿› */
            margin-bottom: 40px; /* æ®µè½é—´è· */
        }

        /* ä¸‹åˆ’çº¿å¡«ç©ºæ ·å¼ */
        .fill-item {
            border-bottom: 1px solid #000; 
            display: inline-block;
            min-width: 60px; 
            text-align: center;
            padding: 0 5px;
            line-height: 1.2; 
            text-indent: 0; 
            font-family: var(--font-fangsong); 
        }

        /* === éªŒè¯ç  === */
        .verify-section {
            /* å­—å·ç»§æ‰¿ .std-text */
            margin-bottom: 10px;
        }

        /* === å£°æ˜ (å”¯ä¸€åŠ ç²—) === */
        .disclaimer {
            /* å­—å·ç»§æ‰¿ .std-text */
            /* å»æ‰ border-top */
            font-weight: bold; /* åªæœ‰è¿™é‡ŒåŠ ç²— */
        }

        /* === è½æ¬¾æ—¥æœŸ === */
        .footer-date {
            margin-top: 80px; 
            text-align: right;
            padding-right: 10px;
            /* å­—å·ç»§æ‰¿ .std-text */
        }

        /* === å°ç«  === */
        .stamp-container {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; 
            overflow: hidden;
        }
        .stamp-img {
            position: absolute;
            width: 150px; 
            top: 600px; 
            left: 400px;
            cursor: move;
            pointer-events: auto;
            mix-blend-mode: multiply;
            z-index: 100;
        }

        /* === æ§åˆ¶é¢æ¿ === */
        .controls {
            position: fixed; bottom: 20px; right: 20px;
            background: rgba(255, 255, 255, 0.98);
            padding: 15px; border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            width: 260px; font-family: sans-serif; font-size: 12px; z-index: 9999;
        }
        .control-group { margin-bottom: 10px; display: flex; align-items: center; justify-content: space-between; gap: 5px; }
        .control-group label { font-weight: bold; min-width: 60px; }
        input[type="range"] { flex: 1; }
        
        button {
            width: 100%; padding: 8px; margin-top: 5px;
            background: #b71c1c; color: white; border: none; border-radius: 4px; 
            cursor: pointer; font-weight: bold;
        }
        button:hover { background: #8e1616; }
        
        .btn-mini { width: auto; padding: 2px 8px; font-size: 12px; background: #2196F3; margin: 0; }
        .file-btn { position: relative; overflow: hidden; background: #FF9800; color: white; padding: 8px; text-align: center; border-radius: 4px; cursor: pointer; font-weight: bold; margin-bottom: 10px; }
        .file-btn input { position: absolute; left: 0; top: 0; opacity: 0; width: 100%; height: 100%; cursor: pointer; }

        [contenteditable]:hover { background-color: rgba(255, 255, 0, 0.1); cursor: text; }
        [contenteditable]:focus { background-color: rgba(230, 247, 255, 0.5); outline: none; }

    </style>
</head>
<body>

    <div class="a4-page">
        <div class="header">
            <img src="ä¸­ä¿¡logo.jpg" id="bankLogo" alt="ä¸­ä¿¡é“¶è¡Œ">
        </div>

        <div class="doc-title" contenteditable="true">
            ä¸ªäººè´·æ¬¾ç»“æ¸…è¯æ˜
        </div>

        <div class="doc-body std-text">
            å€Ÿæ¬¾äººï¼š<span class="fill-item" contenteditable="true">ä¸åº·æ°</span>
            ï¼ˆè¯ä»¶ç±»å‹åŠå·ç ï¼š<span class="fill-item" contenteditable="true" style="min-width: 260px;">å±…æ°‘èº«ä»½è¯å·340102198704060515</span>ï¼‰
            è´·æ¬¾åè®®ç¼–å·ä¸ºï¼š<span class="fill-item" contenteditable="true" style="min-width: 200px;">9007561637562160054</span> 
            çš„ï¼ˆ<span class="fill-item" contenteditable="true">ä¸ªäººå•†ç”¨æˆ¿æŠµæŠ¼è´·æ¬¾-ç»è¥</span>ï¼‰è´·æ¬¾ï¼Œ
            æŠµæŠ¼ç‰©åœ°å€ï¼š<span class="fill-item" contenteditable="true" style="min-width: 320px;">åˆè‚¥å¸‚åºé˜³åŒºè£äº‹è¾¾å¤§é“55å·605å®¤</span>ï¼Œ
            è´·æ¬¾æœŸé™è‡ª <span class="fill-item" contenteditable="true">2025 å¹´ 03 æœˆ 31 æ—¥</span> 
            è‡³ <span class="fill-item" contenteditable="true">2055 å¹´ 03 æœˆ 31 æ—¥</span>ï¼Œ
            å·²äº <span class="fill-item" contenteditable="true">2026 å¹´ 01 æœˆ 05 æ—¥</span> ç»“æ¸…è´·æ¬¾æœ¬æ¯ã€‚
            <br>
            ç‰¹æ­¤è¯æ˜ã€‚
        </div>

        <div class="verify-section std-text">
            éªŒè¯ç ï¼š<span class="fill-item" contenteditable="true" id="verifyCode" style="min-width: 150px; border:none; text-align:left; font-family:Arial;">40D028X7629F3</span>
        </div>

        <div class="disclaimer std-text" contenteditable="true">
            å£°æ˜ï¼šè¯·å‰å¾€ä¸­ä¿¡é“¶è¡Œå®˜æ–¹ç½‘ç«™å½•å…¥ç›¸å…³ä¿¡æ¯åè¿›è¡ŒçœŸä¼ªæ ¸éªŒï¼Œä¸ºä¿è¯æ‚¨çš„æƒç›ŠåŠè¯æ˜çš„å…¬æ­£æ€§ï¼Œè¯·ä¸è¦ç§è‡ªæ ¸éªŒã€‚
        </div>

        <div class="footer-date std-text">
            æ—¥æœŸï¼š<span class="fill-item" contenteditable="true" style="border:none;">2026 å¹´ 01 æœˆ 08 æ—¥</span>
        </div>

        <div class="stamp-container">
            <img src="" class="stamp-img" id="dragStamp" style="display: none;">
        </div>
    </div>

    <div class="controls">
        <div class="control-group">
            <label>Logoå¤§å°</label>
            <input type="range" min="50" max="300" value="120" id="logoSizeRange">
        </div>

        <div class="control-group" style="border-top:1px dashed #ccc; padding-top:10px; margin-top:5px;">
            <label>éªŒè¯ç </label>
            <button class="btn-mini" onclick="generateCode()">ğŸ² éšæœºç”Ÿæˆ</button>
        </div>

        <div style="margin-top:15px; border-top:1px solid #eee; padding-top:10px;">
            <div class="file-btn">
                ğŸ“‚ ä¸Šä¼ å°ç« å›¾ç‰‡
                <input type="file" id="stampUpload" accept="image/*">
            </div>
            
            <div id="stampControls" style="display:none;">
                <div class="control-group">
                    <label>å¤§å°</label>
                    <input type="range" min="50" max="300" value="150" id="stampSize">
                </div>
                <div class="control-group">
                    <label>å·¦å³</label>
                    <input type="range" min="0" max="800" value="400" id="stampX">
                </div>
                <div class="control-group">
                    <label>ä¸Šä¸‹</label>
                    <input type="range" min="0" max="1000" value="600" id="stampY">
                </div>
            </div>
        </div>

        <button onclick="window.print()" style="margin-top:15px;">ğŸ–¨ï¸ æ‰“å° / å­˜ä¸ºPDF</button>
    </div>

    <script>
        // Logo è°ƒæ•´
        const logoImg = document.getElementById('bankLogo');
        document.getElementById('logoSizeRange').addEventListener('input', (e) => {
            logoImg.style.width = e.target.value + 'px';
        });

        // éªŒè¯ç ç”Ÿæˆ (13ä½ = 10æ•°å­— + 3å¤§å†™å­—æ¯)
        function generateCode() {
            const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            const digits = "0123456789";
            let resultArr = [];

            // å–3ä¸ªå­—æ¯
            for(let i=0; i<3; i++) {
                resultArr.push(letters.charAt(Math.floor(Math.random() * letters.length)));
            }
            // å–10ä¸ªæ•°å­—
            for(let i=0; i<10; i++) {
                resultArr.push(digits.charAt(Math.floor(Math.random() * digits.length)));
            }

            // æ´—ç‰Œç®—æ³•
            for (let i = resultArr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [resultArr[i], resultArr[j]] = [resultArr[j], resultArr[i]];
            }

            document.getElementById('verifyCode').innerText = resultArr.join('');
        }

        // å°ç« é€»è¾‘
        const stampImg = document.getElementById('dragStamp');
        const stampControls = document.getElementById('stampControls');
        const rangeSize = document.getElementById('stampSize');
        const rangeX = document.getElementById('stampX');
        const rangeY = document.getElementById('stampY');

        document.getElementById('stampUpload').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if(file) {
                const reader = new FileReader();
                reader.onload = (evt) => {
                    stampImg.src = evt.target.result;
                    stampImg.style.display = 'block';
                    stampControls.style.display = 'block';
                    updateStampPos();
                };
                reader.readAsDataURL(file);
            }
        });

        function updateStampPos() {
            stampImg.style.width = rangeSize.value + 'px';
            stampImg.style.left = rangeX.value + 'px';
            stampImg.style.top = rangeY.value + 'px';
        }
        
        [rangeSize, rangeX, rangeY].forEach(el => {
            el.addEventListener('input', updateStampPos);
        });

        // é¼ æ ‡æ‹–æ‹½
        let isDrag = false, startX, startY, initLeft, initTop;
        
        stampImg.addEventListener('mousedown', (e) => {
            e.preventDefault();
            isDrag = true;
            startX = e.clientX;
            startY = e.clientY;
            initLeft = stampImg.offsetLeft;
            initTop = stampImg.offsetTop;
            stampImg.style.cursor = 'grabbing';
        });

        document.addEventListener('mousemove', (e) => {
            if(!isDrag) return;
            let dx = e.clientX - startX;
            let dy = e.clientY - startY;
            let newLeft = initLeft + dx;
            let newTop = initTop + dy;
            
            stampImg.style.left = newLeft + 'px';
            stampImg.style.top = newTop + 'px';
            rangeX.value = newLeft;
            rangeY.value = newTop;
        });

        document.addEventListener('mouseup', () => {
            isDrag = false;
            stampImg.style.cursor = 'move';
        });
    </script>
</body>
</html>