<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éšæœºå­—ç¬¦ç”Ÿæˆå™¨</title>
    <style>
        body {
            font-family: "Microsoft YaHei", "Segoe UI", sans-serif;
            background-color: #f5f7fa;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .container {
            background: #fff;
            width: 480px;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        }

        h1 {
            text-align: center;
            margin: 0 0 30px 0;
            font-size: 24px;
            color: #ff9800;
        }

        .group { margin-bottom: 25px; }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 14px;
            color: #555;
        }

        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: "Consolas", monospace;
            font-size: 16px;
            box-sizing: border-box;
            resize: vertical;
            transition: border-color 0.3s;
            outline: none;
        }
        textarea:focus { border-color: #ff9800; }

        .info-row {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #999;
            margin-top: 5px;
        }

        .options-panel {
            background: #fafafa;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #eee;
        }

        .row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        .row:last-child { margin-bottom: 0; }

        input[type="checkbox"], input[type="radio"] { cursor: pointer; accent-color: #ff9800; }
        
        input[type="number"] {
            width: 60px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
        }

        .sub-settings {
            display: none;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #e0e0e0;
        }

        .btn-generate {
            width: 100%;
            padding: 14px;
            background: #ff9800;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s;
            margin-top: 10px;
        }
        .btn-generate:hover { background: #f57c00; }

        .result-wrapper { position: relative; }

        .btn-copy {
            position: absolute; right: 10px; top: 10px;
            background: #eee; border: none; padding: 5px 12px;
            border-radius: 4px; font-size: 12px; cursor: pointer; color: #555;
        }
        .btn-copy:hover { background: #e0e0e0; }

        /* é«˜äº®æ˜¾ç¤ºå‰ç¼€ */
        .highlight-prefix {
            color: #ff9800;
            font-weight: bold;
        }

    </style>
</head>
<body>

    <div class="container">
        <h1>ğŸ² éšæœºå­—ç¬¦ç”Ÿæˆå™¨</h1>

        <div class="group">
            <label>1. è¾“å…¥åŸå§‹å­—ç¬¦ä¸² (åœ¨æ­¤ç²˜è´´)</label>
            <textarea id="inputStr" rows="2" placeholder="ä¾‹å¦‚ï¼š340104199001011234" oninput="updateLen()"></textarea>
            <div class="info-row">
                <span>è‡ªåŠ¨è¯†åˆ«é•¿åº¦</span>
                <span>å½“å‰é•¿åº¦: <b id="lenVal" style="color:#ff9800">0</b> ä½</span>
            </div>
        </div>

        <div class="group options-panel">
            
            <div class="row">
                <input type="checkbox" id="enableKeep" onchange="toggleKeep()">
                <label for="enableKeep" style="margin:0; font-weight:normal; cursor:pointer">ä¿ç•™å‰å‡ ä½ (å›ºå®šæ ¼å¼)</label>
            </div>
            <div class="sub-settings" id="keepSettings" style="display: none; background: #fff3e0; padding: 10px; border-radius: 4px;">
                <div class="row">
                    <span style="font-size:14px; color:#555">ä¿ç•™ä½æ•°:</span>
                    <input type="number" id="keepCount" value="6" min="1" oninput="updateLen()">
                    <span style="font-size:12px; color:#999" id="remainTip">(å‰©ä½™ 0 ä½éšæœº)</span>
                </div>
            </div>

            <div style="height: 1px; background: #eee; margin: 10px 0;"></div>

            <div class="row">
                <input type="checkbox" id="hasLetters" onchange="toggleLetters()">
                <label for="hasLetters" style="margin:0; font-weight:normal; cursor:pointer">åŒ…å«å­—æ¯ (åœ¨éšæœºéƒ¨åˆ†)</label>
            </div>

            <div class="sub-settings" id="letterSettings">
                <div class="row">
                    <span style="font-size:14px; color:#555">å­—æ¯æ•°é‡:</span>
                    <input type="number" id="letterCount" value="2" min="1" max="100">
                </div>
                <div class="row">
                    <span style="font-size:14px; color:#555">å­—æ¯å¤§å°å†™:</span>
                    <label style="font-weight:normal; font-size:13px; margin:0"><input type="radio" name="letterCase" value="upper" checked> å¤§å†™</label>
                    <label style="font-weight:normal; font-size:13px; margin:0"><input type="radio" name="letterCase" value="lower"> å°å†™</label>
                    <label style="font-weight:normal; font-size:13px; margin:0"><input type="radio" name="letterCase" value="mixed"> æ··åˆ</label>
                </div>
            </div>
        </div>

        <button class="btn-generate" onclick="generate()">âš¡ ç”Ÿæˆéšæœºç»“æœ</button>

        <div class="group" style="margin-top: 30px;">
            <label>2. ç”Ÿæˆç»“æœ</label>
            <div class="result-wrapper">
                <textarea id="outputStr" rows="2" readonly placeholder="ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®ç”Ÿæˆ..."></textarea>
                <button class="btn-copy" onclick="copyResult()">å¤åˆ¶</button>
            </div>
        </div>
    </div>

    <script>
        // æ›´æ–°é•¿åº¦æ˜¾ç¤º
        function updateLen() {
            const str = document.getElementById('inputStr').value;
            const totalLen = str.length;
            document.getElementById('lenVal').innerText = totalLen;

            // å¦‚æœå¼€å¯äº†ä¿ç•™æ¨¡å¼ï¼Œæ›´æ–°æç¤º
            if(document.getElementById('enableKeep').checked) {
                let keep = parseInt(document.getElementById('keepCount').value) || 0;
                if(keep > totalLen) keep = totalLen;
                const remain = totalLen - keep;
                document.getElementById('remainTip').innerText = `(å‰ ${keep} ä½å›ºå®šï¼Œå ${remain} ä½éšæœº)`;
            }
        }

        function toggleKeep() {
            const isChecked = document.getElementById('enableKeep').checked;
            document.getElementById('keepSettings').style.display = isChecked ? 'block' : 'none';
            updateLen();
        }

        function toggleLetters() {
            const isChecked = document.getElementById('hasLetters').checked;
            document.getElementById('letterSettings').style.display = isChecked ? 'block' : 'none';
        }

        function generate() {
            const input = document.getElementById('inputStr').value;
            const length = input.length;

            if (length === 0) {
                alert("è¯·å…ˆè¾“å…¥åŸå§‹å­—ç¬¦ä¸²ï¼");
                return;
            }

            // 1. å¤„ç†ä¿ç•™å‰ç¼€
            let keepLen = 0;
            let prefix = "";
            if (document.getElementById('enableKeep').checked) {
                keepLen = parseInt(document.getElementById('keepCount').value) || 0;
                if (keepLen > length) keepLen = length;
                prefix = input.substring(0, keepLen); // æå–å‰ç¼€
            }

            // 2. è®¡ç®—éœ€è¦ç”Ÿæˆçš„éšæœºé•¿åº¦
            const genLen = length - keepLen;

            if (genLen === 0) {
                // å¦‚æœå…¨ä¿ç•™äº†ï¼Œç›´æ¥è¿”å›åŸå­—ç¬¦ï¼ˆæˆ–è€…å‰ç¼€ï¼‰
                document.getElementById('outputStr').value = prefix;
                return;
            }

            // 3. ç”Ÿæˆéšæœºéƒ¨åˆ†
            const hasLetters = document.getElementById('hasLetters').checked;
            let randomArr = [];

            if (!hasLetters) {
                // çº¯æ•°å­—
                for (let i = 0; i < genLen; i++) {
                    randomArr.push(getRandomDigit());
                }
            } else {
                // å­—æ¯æ··åˆ
                let letterCount = parseInt(document.getElementById('letterCount').value) || 0;
                // æ ¡éªŒï¼šå­—æ¯ä¸èƒ½è¶…è¿‡éšæœºéƒ¨åˆ†çš„æ€»é•¿
                if (letterCount > genLen) letterCount = genLen;

                const numberCount = genLen - letterCount;
                const caseType = document.querySelector('input[name="letterCase"]:checked').value;

                // ç”Ÿæˆå­—æ¯
                for (let i = 0; i < letterCount; i++) {
                    randomArr.push(getRandomLetter(caseType));
                }
                // ç”Ÿæˆæ•°å­—
                for (let i = 0; i < numberCount; i++) {
                    randomArr.push(getRandomDigit());
                }
                // æ‰“ä¹±
                shuffleArray(randomArr);
            }

            // 4. æ‹¼æ¥å¹¶è¾“å‡º
            const result = prefix + randomArr.join('');
            document.getElementById('outputStr').value = result;
        }

        function getRandomDigit() {
            return Math.floor(Math.random() * 10).toString();
        }

        function getRandomLetter(caseType) {
            const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
            let pool = "";
            if (caseType === 'upper') pool = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            else if (caseType === 'lower') pool = "abcdefghijklmnopqrstuvwxyz";
            else pool = chars;
            return pool.charAt(Math.floor(Math.random() * pool.length));
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function copyResult() {
            const output = document.getElementById('outputStr');
            if (!output.value) return;
            output.select();
            document.execCommand('copy');
            
            const btn = document.querySelector('.btn-copy');
            const originalText = btn.innerText;
            btn.innerText = "å·²å¤åˆ¶!";
            setTimeout(() => { btn.innerText = originalText; }, 1500);
        }
    </script>
</body>
</html>