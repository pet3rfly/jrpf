<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>农行批复通知</title>
    <style>
        :root {
            --theme-color: #008d7c;
            --bg-gray: #f2f2f2;
            --border-color: #999;
            --main-font: "SimSun", "Songti SC", serif;
            --accent-font: "Microsoft YaHei", "Heiti SC", sans-serif;
        }

        body {
            font-family: var(--main-font);
            margin: 0;
            padding: 20px;
            background-color: #fff;
            color: #333;
            min-height: 100vh;
            overflow-x: auto; 
        }

        .main-container {
            width: 1200px;
            margin: 0 auto;
            position: relative;
        }

        /* ---------------- 头部区域 ---------------- */
        .header {
            text-align: center;
            margin-bottom: 0;
            /* 1. 顶部间距增加：原先靠body padding，现在额外增加 60px */
            margin-top: 60px; 
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .header h1 {
            font-size: 24px;
            font-weight: bold;
            margin: 0;
            color: #000;
            letter-spacing: 2px;
        }

        .print-date-wrapper {
            font-size: 16px;
            color: #333;
            cursor: pointer;
            position: relative;
            padding: 5px 10px;
            display: inline-block;
        }
        .print-date-wrapper:hover {
            background-color: #f0f0f0;
            border-radius: 4px;
        }
        
        #printDateInput {
            position: absolute;
            top: -10%; left: -10%; 
            width: 120%; height: 120%; 
            opacity: 0; 
            z-index: 999; 
            cursor: pointer;
        }

        .export-btn {
            background-color: var(--theme-color);
            color: #fff;
            border: none;
            padding: 8px 30px;
            font-size: 16px;
            border-radius: 8px; 
            cursor: pointer;
            font-family: var(--accent-font);
            margin-bottom: -1px;
            position: relative;
            z-index: 5;
        }
        .export-btn:hover { opacity: 0.9; }

        /* ---------------- 表格区域 ---------------- */
        .loan-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid var(--border-color);
            font-size: 16px;
            white-space: nowrap; 
        }

        .loan-table td {
            border: 1px solid var(--border-color);
            padding: 0; 
            height: 28px;
            vertical-align: middle;
        }

        .cell-content {
            padding: 0 10px;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            box-sizing: border-box; 
        }

        .loan-table tr:nth-child(odd) { background-color: var(--bg-gray); }
        .loan-table tr:nth-child(even) { background-color: #fff; }

        .label-text {
            color: var(--theme-color);
            font-weight: bold;
            text-align: center;
            display: block;
            width: 100%;
        }

        .loan-table td:nth-child(1),
        .loan-table td:nth-child(3) {
            width: 200px; 
            text-align: center;
        }

        .table-input {
            width: 100%; height: 100%; border: none; outline: none;
            background: transparent; font-family: var(--main-font);
            font-size: 16px; color: #000; padding: 0; margin: 0;
            text-align: left; 
        }

        /* 无痕下拉菜单 */
        .clean-select {
            width: 100%; height: 100%; border: none; outline: none;
            background: transparent; font-family: var(--main-font);
            font-size: 16px; color: #000; padding: 0; margin: 0;
            appearance: none; -webkit-appearance: none; -moz-appearance: none;
            cursor: pointer;
        }
        .clean-select::-ms-expand { display: none; }

        /* 分栏布局 */
        .split-cell-container { display: flex; width: 100%; height: 100%; align-items: stretch; }
        .split-value { flex: 3; border-right: none; padding: 0 10px; display: flex; align-items: center; }
        .split-unit { flex: 1; display: flex; align-items: center; justify-content: flex-start; padding-left: 0px; color: #000; }

        .footer-note {
            margin-top: 5px; font-size: 14px; color: red; font-family: var(--accent-font);
        }

        /* ---------------- 控制面板 ---------------- */
        .control-panel {
            position: fixed; bottom: 20px; right: 20px; background: #fff;
            border: 1px solid #ccc; padding: 15px; z-index: 9999;
            width: 240px; box-shadow: 0 0 15px rgba(0,0,0,0.2);
            border-radius: 8px; font-size: 12px; font-family: var(--main-font);
            transition: all 0.3s ease;
        }
        .control-panel.collapsed {
            width: 40px; height: 40px; padding: 0; border-radius: 50%;
            background: var(--theme-color); cursor: pointer;
            display: flex; align-items: center; justify-content: center;
        }
        .control-panel.collapsed .panel-content { display: none; }
        .toggle-icon { display: none; color: white; font-size: 20px; }
        .control-panel.collapsed .toggle-icon { display: block; }

        .panel-header {
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid #eee; margin-bottom: 10px; padding-bottom: 5px;
        }
        .panel-header h4 { margin: 0; color: #333; }
        /* 新的折叠按钮样式 (16px方形) */
.minimize-btn { 
    cursor: pointer; 
    font-size: 16px; 
    width: 16px; 
    height: 16px; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    font-weight: bold;
    color: #666;
}
.minimize-btn:hover {
    color: #000;
    background-color: #f0f0f0;
    border-radius: 2px;
}
        .control-row { margin-bottom: 10px; }
        .control-row label { display: block; margin-bottom: 4px; font-weight: bold; color: #555; }
        .control-row select, .control-row input { width: 95%; padding: 4px; }
        .btn-action { width: 100%; padding: 6px 0; background-color: #f0f0f0; border: 1px solid #ccc; cursor: pointer; margin-top: 5px; }
    </style>
</head>
<body>

    <div class="main-container">
        <div class="header">
            <h1>贷款审批通知书</h1>
            <div class="print-date-wrapper">
                打印日期：<span id="printDateText">2025年12月18日</span>
                <input type="date" id="printDateInput" onchange="updatePrintDate(this.value)" onclick="this.showPicker()">
            </div>
            <button class="export-btn">导出为Word文档</button>
        </div>

        <table class="loan-table">
            <tr>
                <td><div class="cell-content"><span class="label-text">申请书编号</span></div></td>
                <td colspan="3"><div class="cell-content"><input type="text" class="table-input" id="appNumber" value="34300202572722741"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">客户名称</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="周荣"></div></td>
                <td><div class="cell-content"><span class="label-text">客户代码</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" id="custCode" value="1639504313407339"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">业务品种</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="房抵贷——经营"></div></td>
                <td><div class="cell-content"><span class="label-text">是否低风险</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="是"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">是否循环贷款单笔用信审批</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="否"></div></td>
                <td><div class="cell-content"><span class="label-text">关联循环合同编号</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">合作品种编号</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input"></div></td>
                <td><div class="cell-content"><span class="label-text">合作项目编号</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">合作项目名称</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input"></div></td>
                <td><div class="cell-content"><span class="label-text">特色产品</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">贷款性质</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="自营常规贷款"></div></td>
                <td><div class="cell-content"><span class="label-text">委托人分类</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">贷款金额</span></div></td>
                <td>
                    <div class="split-cell-container">
                        <div class="split-value"><input type="text" class="table-input" value="4,500,000.00"></div>
                        <div class="split-unit">元</div>
                    </div>
                </td>
                <td><div class="cell-content"><span class="label-text">期限</span></div></td>
                <td>
                    <div class="split-cell-container">
                        <div class="split-value"><input type="text" class="table-input" value="36"></div>
                        <div class="split-unit">月</div>
                    </div>
                </td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">是否循环</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="否"></div></td>
                <td><div class="cell-content"><span class="label-text">循环审批方式</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">循环额度金额</span></div></td>
                <td>
                    <div class="split-cell-container">
                        <div class="split-value"><input type="text" class="table-input" value="0.00"></div>
                        <div class="split-unit">元</div>
                    </div>
                </td>
                <td><div class="cell-content"><span class="label-text">循环额度期限</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">首笔贷款业务品种</span></div></td>
                <td>
                    <div class="cell-content">
                        <select class="clean-select">
                            <option selected>房抵贷——经营</option>
                            <option>房抵贷——消费</option>
                        </select>
                    </div>
                </td>
                <td></td><td></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">贷款用途</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="经营"></div></td>
                <td><div class="cell-content"><span class="label-text">贷款用途说明</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">首付金额</span></div></td>
                <td>
                    <div class="split-cell-container">
                        <div class="split-value"><input type="text" class="table-input" value="0.00"></div>
                        <div class="split-unit">元</div>
                    </div>
                </td>
                <td><div class="cell-content"><span class="label-text">首付比例</span></div></td>
                <td>
                    <div class="cell-content">
                        <input type="text" class="table-input" value="0.00 %" onfocus="removeSuffix(this, ' %')" onblur="addSuffixRatio(this)">
                    </div>
                </td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">还款来源</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="经营收入"></div></td>
                <td><div class="cell-content"><span class="label-text">担保方式</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="抵押"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">是否有共同借款人</span></div></td>
                <td>
                    <div class="cell-content">
                        <select class="clean-select">
                            <option selected>否</option>
                            <option>是</option>
                        </select>
                    </div>
                </td>
                <td><div class="cell-content"><span class="label-text">是否公积金组合贷款</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="否"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">还款方式</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="一次性还本按约还息"></div></td>
                <td><div class="cell-content"><span class="label-text">基准利率类别</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="贷款市场报价利率"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">执行利率类别</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="浮动利率"></div></td>
                <td><div class="cell-content"><span class="label-text">利率浮动周期</span></div></td>
                <td>
                    <div class="cell-content">
                        <select class="clean-select">
                            <option selected>按12个月</option>
                            <option>按36个月</option>
                            <option>按60个月</option>
                        </select>
                    </div>
                </td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">利率浮动方式</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="浮点"></div></td>
                <td><div class="cell-content"><span class="label-text">利率浮动幅度</span></div></td>
                <td>
                    <div class="cell-content">
                        <input type="text" class="table-input" value="31.00000 万分之" onfocus="removeSuffix(this, ' 万分之')" onblur="addSuffixFloat(this)">
                    </div>
                </td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">审批意见</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" value="同意"></div></td>
                <td><div class="cell-content"><span class="label-text">审批机构</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" id="approvalOrg" value="合肥望江东路支行行长室"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">经营机构</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" id="operatingOrg" value="合肥望江东路支行"></div></td>
                <td><div class="cell-content"><span class="label-text">批复有效截止日期</span></div></td>
                <td><div class="cell-content"><input type="text" class="table-input" id="tableEndDate" value="2026-02-16"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">信用发放条件</span></div></td>
                <td colspan="3"><div class="cell-content"><input type="text" class="table-input"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">其他要求</span></div></td>
                <td colspan="3"><div class="cell-content"><input type="text" class="table-input"></div></td>
            </tr>
            <tr>
                <td><div class="cell-content"><span class="label-text">审批意见说明</span></div></td>
                <td colspan="3"><div class="cell-content"><input type="text" class="table-input" value="同意"></div></td>
            </tr>
        </table>

        <div class="footer-note">
            循环额度与首笔用信同时审批时，贷款金额即首笔用信金额，期限即首笔用信期限。
        </div>
    </div>

    <div class="control-panel" id="controlPanel">
        <div class="toggle-icon" onclick="toggleControlPanel()">⚙</div>
        
        <div class="panel-content">
            <div class="panel-header">
                <h4>操作与设置</h4>
                <span class="minimize-btn" onclick="toggleControlPanel()">_</span>
            </div>

            <div class="control-row">
                <button class="btn-action" onclick="refreshNumbers()">刷新编号</button>
            </div>

            <div class="control-row">
                <label>选择支行：</label>
                <select id="branchSelect" onchange="updateBranchInfo()">
                    </select>
            </div>

            <div class="control-row">
                <label>批复日期 (影响截止日期)：</label>
                <input type="date" id="panelApproveDate" onchange="updateDateLogic()">
            </div>
            
        </div>
    </div>

    <script>
        const branches = [
            "七里塘", "万达广场", "临泉路", "临湖", "北城", "南岗", "史河路", 
            "城东", "天柱路", "天鹅湖", "小庙", "新政务区", "望江东路", "桃花工业园区", "磨店"
        ];

        window.onload = function() {
            // 1. 填充支行
            const select = document.getElementById('branchSelect');
            branches.forEach(br => {
                const option = document.createElement('option');
                option.value = br;
                option.text = br;
                if(br === '望江东路') option.selected = true; 
                select.appendChild(option);
            });

            // 2. 自动设置日期为今天
            const today = new Date();
            const yyyy = today.getFullYear();
            const mm = String(today.getMonth() + 1).padStart(2, '0');
            const dd = String(today.getDate()).padStart(2, '0');
            const todayStr = `${yyyy}-${mm}-${dd}`;
            
            // 设置中文格式给打印日期
            const printDateStr = `${yyyy}年${mm}月${dd}日`;
            document.getElementById('printDateText').innerText = printDateStr;

            // 设置输入框
            document.getElementById('panelApproveDate').value = todayStr;
            document.getElementById('printDateInput').value = todayStr;
            
            // 立即计算截止日期
            updateDateLogic();
        };

        function removeSuffix(el, suffix) {
            let val = el.value;
            if (val.endsWith(suffix)) {
                el.value = val.replace(suffix, '');
            }
        }

        function addSuffixRatio(el) {
            let val = el.value.trim();
            if (!val) return;
            val = val.replace(' %', '').replace('%', '');
            let num = parseFloat(val);
            if (!isNaN(num)) {
                el.value = num.toFixed(2) + ' %';
            } else {
                el.value = val; 
            }
        }

        function addSuffixFloat(el) {
            let val = el.value.trim();
            if (!val) return;
            val = val.replace(' 万分之', '');
            let num = parseFloat(val);
            if (!isNaN(num)) {
                el.value = num.toFixed(5) + ' 万分之';
            } else {
                el.value = val;
            }
        }

        function refreshNumbers() {
            const appPrefix = "343002025";
            let appSuffix = "";
            for(let i=0; i<8; i++) appSuffix += Math.floor(Math.random() * 10);
            document.getElementById('appNumber').value = appPrefix + appSuffix;

            const custPrefix = "1639500";
            let custSuffix = "";
            for(let i=0; i<10; i++) custSuffix += Math.floor(Math.random() * 10);
            document.getElementById('custCode').value = custPrefix + custSuffix;
        }

        function updateBranchInfo() {
            const branchName = document.getElementById('branchSelect').value;
            const opOrg = `合肥${branchName}支行`;
            document.getElementById('operatingOrg').value = opOrg;
            const appOrg = `合肥${branchName}支行行长室`;
            document.getElementById('approvalOrg').value = appOrg;
        }

        function updateDateLogic() {
            const panelDateStr = document.getElementById('panelApproveDate').value;
            if(!panelDateStr) return;
            const date = new Date(panelDateStr);
            date.setDate(date.getDate() + 60);
            const yyyy = date.getFullYear();
            const mm = String(date.getMonth() + 1).padStart(2, '0');
            const dd = String(date.getDate()).padStart(2, '0');
            document.getElementById('tableEndDate').value = `${yyyy}-${mm}-${dd}`;
        }

        function updatePrintDate(val) {
            if(!val) return;
            const date = new Date(val);
            const yyyy = date.getFullYear();
            const mm = String(date.getMonth() + 1).padStart(2, '0');
            const dd = String(date.getDate()).padStart(2, '0');
            document.getElementById('printDateText').innerText = `${yyyy}年${mm}月${dd}日`;
        }

        function toggleControlPanel() {
            document.getElementById('controlPanel').classList.toggle('collapsed');
        }
    </script>
</body>
</html>